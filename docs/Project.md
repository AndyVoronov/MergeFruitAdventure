# Project.md

## 1. Описание проекта
**Название:** Merge Fruit Adventure
**Жанр:** 2D merge-головоломка для браузера и мобильных устройств
**Цель:** Создать кроссплатформенную, визуально привлекательную игру с высокой вовлечённостью и монетизацией.

## 2. Цели и задачи
- Разработка простой, затягивающей механики слияния фруктов
- Кроссплатформенность (Web, iOS, Android)
- Монетизация (реклама, покупки, бонусы)
- Локализация (EN, RU, ES, CN)
- Социальные функции (лидерборды, достижения, шаринг)

## 3. Архитектура
### 3.1. Клиент
- **Движок:** Phaser 3 / PixiJS / Godot (HTML5 экспорт)
- **UI:** Адаптивный, сенсорное и мышиное управление
- **Локализация:** Модульная, расширяемая
- **PWA:** Поддержка для мобильных устройств

### 3.2. Сервер
- **Backend:** Node.js или Firebase
- **Функции:** Хранение прогресса, лидерборды, аналитика, валидация результатов
- **Безопасность:** Валидация данных, защита от читов, авторизация

### 3.3. Монетизация
- Реклама (баннеры, награды, межуровневая)
- Встроенные покупки (валюта, бустеры, подписка)

### 3.4. Социальные функции
- Лидерборды (глобальные, друзья)
- Достижения
- Шаринг прогресса
- Авторизация (Google, Apple, анонимно)

## 4. Этапы разработки
1. **Предпроизводство:** GDD, прототип, референсы, выбор стека
2. **Разработка:** Механика, ассеты, звук, backend, тесты
3. **Тестирование:** QA, багфиксы, баланс, локализация, бета
4. **Релиз:** Софт-лонч, аналитика, доработка, глобальный релиз

## 5. Технологии и стандарты
- **Frontend:** Phaser 3 / PixiJS / Godot, TypeScript/JavaScript
- **Backend:** Node.js/Firebase
- **PWA:** Web App Manifest, Service Worker
- **CI/CD:** GitHub Actions, автоматизация сборки и деплоя
- **Локализация:** i18n, поддержка расширения языков
- **Тестирование:** Unit, интеграционное, кроссбраузерное
- **Документирование:** Обновление Project.md при изменениях архитектуры или требований

## 6. Консистентность и поддерживаемость
- Модульная архитектура
- Единые стандарты кодирования
- Автоматизация тестирования и деплоя
- Документирование всех изменений

## 7. Критерии успеха
- 60 FPS, загрузка <5 сек, стабильность на всех платформах
- Положительный фидбэк >80% на бете
- Реализация всех ключевых функций
- Лёгкая поддержка и расширение 

## Полезные ссылки
- Backend (Render): https://mergefruitadventure.onrender.com
- Frontend (Vercel): https://merge-fruit-adventure.vercel.app/
- Supabase (DB): https://supabase.com/dashboard/project/qoefhhylwyjdofvwrdcw/database/schemas
- Telegram Mini Apps: https://core.telegram.org/bots/webapps#initializing-mini-apps
- Репозиторий GitHub: https://github.com/AndyVoronov/MergeFruitAdventure

## FAQ: типовые ошибки и лучшие практики
- **Ошибка "Application exited early" на Render**: 
  - Причина: backend не слушал порт, требуемый Render (PORT из process.env), либо не было app.listen().
  - Решение: всегда используйте
    ```js
    const PORT = process.env.PORT || 3001;
    app.listen(PORT, ...);
    ```
- **Фронтенд не видит backend**:
  - Причина: в коде был указан localhost вместо публичного адреса Render.
  - Решение: всегда используйте публичный URL backend для fetch-запросов с фронта.
- **Best practice**:
  - Всегда добавляйте логирование старта сервера и ошибок (console.log, console.error) — это ускоряет диагностику.
  - Для production не храните секреты (ключи Supabase) в коде, используйте переменные окружения Render.
  - Все важные ссылки и инструкции фиксируйте в этом разделе документации. 